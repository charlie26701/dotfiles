#!/usr/bin/env bash

pkg_installed() {
	local PKG=$1
	if pacman -Qi $PKG &>/dev/null; then
		return 0
	else
		return 1
	fi
}
cd ~

# Font
sudo pacman -S noto-fonts noto-fonts-cjk noto-fonts-emoji --noconfirm && yay -S ttf-ms-win11-auto --noconfirm
echo "[*] Copy fonts ..."
mkdir -p ~/.fonts && cp -r ~/dotf/.fonts/* ~/.fonts
fc-cache -fv
echo "[*] Done."
sleep 3 && clear

# Icon theme && Cursor theme
echo "[*] Copy icons ..."
mkdir -p ~/.icons && cp -r ~/dotf/.icons/* ~/.icons
echo "[*] Done."
sleep 3 && clear

# Themes
echo "[*] Copy themes ..."
mkdir -p ~/.themes && cp -r ~/dotf/.themes/* ~/.themes
echo "[*] Done."
sleep 3 && clear

# Wallpaper
echo "[*] Copy wallpaper ..."
mkdir -p ~/.walls && cp -r ~/dotf/.walls/* ~/.walls
echo "[*] Done."
sleep 3 && clear

# Config
echo "[*] Copy config ..."
if ! [ -d $HOME/.config ]; then
	mkdir -p $HOME/.config
fi
cp -r ~/dotf/.config/* ~/.config
echo "[*] Done."
sleep 3 && clear

# Local
echo "[*] Copy local ..."
if ! [ -d $HOME/.local ]; then
	mkdir -p $HOME/.local
fi
cp -r ~/dotf/.local/* ~/.local
echo "[*] Done."
sleep 3 && clear

# Root
echo "[*] Copy root ..."
mkdir -p ~/.root && cp -r ~/dotf/.root/* ~/.root
echo "[*] Done."
sleep 3 && clear

# .Xresources
echo "[*] Copy .Xresources ..."
rm -f ~/.Xresources && cp ~/dotf/.Xresources ~/.Xresources
echo "[*] Done."
sleep 3 && clear

# .gtkrc-2.0
echo "[*] Copy .gtkrc-2.0 ..."
rm -f ~/.gtkrc-2.0 && cp ~/dotf/.gtkrc-2.0 ~/.gtkrc-2.0
echo "[*] Done."
sleep 3 && clear

##################### Install config WM #####################
read -p "[*] Do you want to use my WM configs? (1 for AwesomeWM/2 for mAWMcos/3 for AGS): " choice
if [ "$choice" = "1" ]; then
	echo "[*] Installing AwesomeWM ..."
	yay -S awesome-git lua-pam-git --noconfirm
	rm -rf ~/.config/awesome
	git clone https://github.com/sownteedev/dotfiles.git --branch=awesome ~/.config/awesome
	echo "[*] Done."
elif [ "$choice" = "2" ]; then
	echo "[*] Installing mAWMcos ..."
	yay -S awesome-git lua-pam-git --noconfirm
	rm -rf ~/.config/awesome
	git clone https://github.com/sownteedev/dotfiles.git --branch=mAWMcos ~/.config/awesome
	echo "[*] Done."
elif [ "$choice" = "3" ]; then
	echo "[*] Config for AGS is comming soon ^^"
fi
sleep 3 && clear

######################################## MY CONFIG FOR CUSTOM APPS #######################################

# Spotify
echo "[*] Installing Spotify ..."
yay -S spotify --noconfirm
yay -S --noconfirm spicetify-cli-git
sudo chmod a+wr /opt/spotify
sudo chmod a+wr /opt/spotify/Apps -R
spicetify config current_theme Tetify
echo "[*] Done."
sleep 3 && clear

# Firefox
echo "[*] Installing Firefox ..."
yay -S firefox firefox-pwa --noconfirm
xdg-settings set default-web-browser firefox.desktop
git clone https://github.com/vinceliuice/WhiteSur-firefox-theme.git
cd WhiteSur-firefox-theme
./install.sh -a
cd .. && rm -rf WhiteSur-firefox-theme
echo "[*] Done."
sleep 3 && clear

# Grtub Theme
echo "[*] Installing Grub Theme ..."
sudo cp -r ~/.root/grub/themes/virtuaverse /boot/grub/themes/
sudo sed -i 's/#GRUB_THEME=.*/GRUB_THEME=\/boot\/grub\/themes\/virtuaverse\/theme.txt/g' /etc/default/grub
sudo grub-mkconfig -o /boot/grub/grub.cfg
echo "[*] Done."
sleep 3 && clear

# Lightdm
echo "[*] Installing Lightdm ..."
yay -S --noconfirm lightdm lightdm-webkit2-greeter lightdm-webkit2-theme-glorious
sudo systemctl enable lightdm
sudo sed -i 's/#greeter-session=[^ ]*/greeter-session=lightdm-webkit2-greeter/' /etc/lightdm/lightdm.conf
sudo sed -i 's/^webkit_theme\s*=\s*\(.*\)/webkit_theme = glorious #\1/g' /etc/lightdm/lightdm-webkit2-greeter.conf
sudo sed -i 's/^debug_mode\s*=\s*\(.*\)/debug_mode = true #\1/g' /etc/lightdm/lightdm-webkit2-greeter.conf
sudo cp ~/.walls/* /usr/share/backgrounds
echo "[*] Done."
sleep 3 && clear

# Install TeVim
echo "[*] Installing TeVim ..."
sudo pacman -Rns neovim --noconfirm
yay -S --noconfirm lazygit xclip xsel fzf ripgrep neovim-nightly-bin
rm -rf ~/.config/nvim
git clone https://github.com/sownteedev/TeVim.git --depth 1 ~/.config/nvim
cp -r ~/dotf/.config/nvim/lua/custom ~/.config/nvim/lua/
echo "[*] Done."
sleep 3 && clear

# App for me
echo "[*] Installing apps for me ..."
sudo pacman -S --noconfirm telegram-desktop
yay -S --noconfirm notion-app-electron jetbrains-toolbox mysql-workbench docker-desktop postman-bin ulauncher-git appimagelauncher-bin caprine vesktop thunderbird anydesk-bin

# MongoDB
yay -S --noconfirm mongodb-bin mongodb-compass
sudo systemctl enable mongodb

# VMWare
yay -S --noconfirm vmware-workstation
sudo systemctl enable vmware-networks.service

# Fix WPS
yay -S --noconfirm wps-office libtiff5
sudo sed -i '3i export XMODIFIERS="@im=ibus" export QT_IM_MODULE="ibus"' /usr/bin/wps /usr/bin/et /usr/bin/wpp
sudo ln -s /usr/lib/libtiff.so.6 /usr/lib/libtiff.so.5
sudo chmod -x /usr/lib/office6/wpsoffice

sudo pacman -Rns docker-desktop-debug --noconfirm
yay -S visual-studio-code-bin --noconfirm
echo "[*] Done."
sleep 3 && clear

sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)"
